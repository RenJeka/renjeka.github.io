# Проект для Программы получения опыта по специальности Front-end.
# Документация

___

### Краткое описание

> Проект представляет собой клиентское одностраничное приложение, которое будет предоставлять возможность манипулировать данными связанными с авторами и их книгами.

## Как пользоваться приложением

##### Чтобы начать работать с приложением, необходимо:
1. Открыть страницу с приложением.
2. Добавить один или несколько жанров, для этого
	+ Откройте страницу с жанрами, (нажмите на иконку со стрелкой внизу и выберите изображение масок).
	+ Заполните поле "Название жанра" в разделе "Добавить Жанр".
	+ Нажмите кнопку "добавить".
	+ Для измения жанра выберите его в таблице и нажмите кнопку "Изменить".
	+ Для удаления жанра выберите его в таблице и нажмите кнопку "Удалить".
	+ Чтобы очистить выделенное поле, нажмите кнопку "Очистить поля"
	+ Работа с формой для заполнения, таблицей и кнопками "Добавить", "Изменить", "Удалить", "Очистить поля" — аналогична на всех страницах приложения
	+ Чтобы найти жанр по названию — введите совпадающие символы в   поле поиска.
3. Добавить одну или несколько книг, для этого:
	+ Перейдите на страницу с книгами, (нажмите на иконку со стрелкой внизу и выберите изображение книги).
	+ Заполните поля в разделе "Добавить книгу" и добавьте одну или несколько книг.
	+ Чтобы найти книгу по названию — введите совпадающие символы в   поле поиска.
4. Добавитььодного или нескольких авторов, для этого:
	+ Перейдите обратно на страницу с авторами, (нажмите на иконку со стрелкой внизу и выберите изображение автора).
	+ Заполните поля в разделе "Добавить автора" и добавьте одного или нескольких авторов.
	+ Для выбора нескольких книг — удерживайте `Ctrl` или `(Command)` в поле "Список книг" и выберите левой кнопкой миши несколько книг.
	+ Чтобы найти автора по фамилии — введите совпадающие символы в   поле поиска.
5. Вы всегда можете добавить, удалить или изменить внесенные Вами данные.
6. Данных сохраняются в локальном хранилище браузера (LocalStorage). Данные будут хранится до тех пор, пока вы самостоятельно не очистите локальное хранилище. 
В случае удаления браузера, либо сбоя системы данные могут удалиться. 

## СТРУКТУРА ПРИЛОЖЕНИЯ


Приложение создавалось при помощи Webpack 4-й версии. 
Приложение имеет 3 (три) точки входа (`index.js`, `indexAuthor.js` и `indexGenre.js`), и 3 (три) бандла.

Приложение маннипулирует данными, которые разделяются на 3 категории: **Книги**, **Авторы**, **Жанры**. Каждая категория представлена в виде таблицы с формой для её заполнения, полем поиска и кнопками управления (Записать, изменить, удалить, очистить поля).

Для работы приложения исходные файлы разделены по такому принципу:
------------------------------------------------------------------

Файлы `index.js` ,  `indexAuthor.js` и `indexGenre.js`  связаны с *`index.html`*, *`add_author.html`* и  *`add_genre.html`* соответственно. Каждый файл .js обрабатывает свой .html файл

♦ **`index.js`** — Файл, с которого начинается работа приложения. В нем заключена работа с таблицой и формой для работы с объектом - "книга".

♦ Файлы **`indexAuthor.js`** и **`indexGenre.js`** аналогично работают с объектами "*Автор*" и "*Жанр*" (соответственно)

Предполагается, что 1 таблица работает с  1-й формой и обслуживает 1 тип объекта

♦ Для каждого такого объекта существует отдельный класс в виде файла ".js" (папка "objectsClasses")
**`books.js`** — класс для создания объекта "Книга"
**`author.js`** — класс для создания объекта "Автор"
**`genre.js`** — класс для создания объекта "Жанр"

♦ **`myHelperLib.js`** — вспомагательная библиотека для вспомогательных функций (вместо подключения jQuery)

♦ Файл **`table.class.js`** — один из главных файлов в программе, содержит класс **`Table`**, в котором представлены методы и свойства для работы таблицы.

♦ Файл **`form.class.js`** — один из главных файлов в программе, содержит класс **`Form`**, в котором представлены методы и свойства для работы формы и её взаимодействии с базой данных (LocalStorage) 

♦ файл стилей **`src/css/style1.css`** для придания стилизации.


  РАБОТА ПРИЛОЖЕНИЯ
-----------------

##### Файлы ".js"

>При открытии страницы с данными, на событие загрузки окна создаем 2 объекта (1 класса **`Form`** и 1 класса **`Table`**) — это главные объекты с которыми в дальнейшем проходят все маннипуляции.

>При помощи метода `checkForm` объект класса **`Form`** заполняет необходимые поля ввода по привязке. Далее добавляются наблюдатели при помощи метода класса **`Table`**. Класс **`Table`** является одновременно и издателем и подписчиком — это необходимо для работы метода, который обрабатывает нажатия на строку таблицы. Далее заполняется таблица с базы данных. 

Всплывающее меню обрабатывается отдельной функцией из библиотеки **`myHelperLib.js`**

При введении данных в форму и нажатии на кнопку "**Добавить**" обработчик из главных файлов (index...) запускает поочередно методы экземпляров классов **`Table`** и **`Form`**, которые сначала считывают данные из полей ввода, записывают в базу данных, затем выводят в таблицу. Данные проходит такой цикл: 
1. Проверка валидации
2. Cоздание необходимого объекта. 
3. Заполнение созданного объекта. 
4. Проверка на дубликат (по умолчанию по полю "id")
5. Очистка введенных полей.
6. Добавление объекта в базу данных.

--------

При клике на строку таблицы запускается встроенный либо пользовательский обработчик событий, который вычисляет по строке таблицы нужный объект в массиве объектов. В дальнейшем манипуляция с выделенной строкой идет не как со строкой, а как с объектом из массива. 
Тут существует 2 отдельных массива данных с которыми работает пользователь: 
- один у экземпляра класса **`Table`**, который представлет текущие данные которые выведенны в таблицу;
- один у экземпляра класса **`Form`**, который представляет данные в базе данных.

Эти 2 массива синхронизируются автоматически

---

При выборе строки фиксируется текущий объект, на который указывает строка, и при нажатии кнопки "изменить" или "удалить" срабатывает обработчик, который запускает соответствующие методы.


   СОЗДАНИЕ НОВОЙ ТАБЛИЦЫ
----------------------

Предполагается, что таблица будет создаваться как отдельный модуль (отдельная html-страница и отдельный файл-обработчик), на который пользователь будет ссылаться с основного файла **`index.html`**.

Для создания новой таблици необходимо:

- Создать новый файл .html в директории `src/pages `(структура должна быть такая-же, как и у остальных .html-файлов)
- Задать ссылку на созданный .html-файл
- Создать отдельный файл-обработчик для новой таблицы в папке ./src с именем index<Ваше Название>.js (напр. indexMytable.js)
- создать отдельный клас (какую сущность реального мира будет представлять таблица) в папке `./src` с именем **`<Ваше Название>.class.js`** (напр. `Mytable.class.js`)
- Подключить импорт созданного класса в файле **`form.class.js`**
- Создать экземпляр объекта в конструкции switch метода "fillObject" в файле **`form.class.js`**.

- Заполнить основной **`index<Ваше Название>.js`** - файл, скопировав основную структуру из главного `index.js` файла.
	- Переименовать основные переменные "formBook" и "tableBook"
	- Передать название id своей таблицы и имя экземпляра класса Form — в конструктор класса Table.
	``` javascript
	let tableBook = new Table('#table-books',formBook);
	```



- Создать форму в html-файле, добавив в форму поле с метаданными 
  ```html
  <input type="hidden" ...> 
  ```
	- Тип объекта устанавливается в атрибут **value** в скрытое поле с метаданными 
	- Значение атрибута **id** у каждого поля 'input' — это название свойства объекта в базе данных.
	- Если есть элементы в форме, значения которых не должно попасть в объект в базу данных — добавляем в него атрибут 'ignore'
	- В поля формы, которые требуют привязки другой таблицы, необходимо добавить 2 атрибута:
		- В атрибут **data-local-storage-key-bind** добавить ключ от базы данных (LocalStorage), где хранится массив объектов. 
		- В атрибут **data-object-property-bind** добавить имя свойста у объекта, значение которого будет помещатся в поле ввода (в < option > "select"-а);
	
- Создать саму таблицу в html-файле
	- Каждое свойство объекта создается через <th>. В атрибут **data-object-key-bind** указывается название поля объекта, по которому в данный столбец будут выводится значения.
	
- Создать поле поиска (фильтра).
	- В атрибуте **data-search-object-property** Указать по какому свойству у объекта будет осуществлятся поиск.
